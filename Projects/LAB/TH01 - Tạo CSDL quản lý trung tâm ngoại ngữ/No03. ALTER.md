# **Lแปnh ALTER TABLE trong SQL: Chi Tiแบฟt vร แปจng Dแปฅng**

Lแปnh **`ALTER TABLE`** lร mแปt trong nhแปฏng cรขu lแปnh **Data Definition Language (DDL)** quan trแปng trong SQL, dรนng ฤแป **thay ฤแปi cแบฅu trรบc bแบฃng** sau khi ฤรฃ tแบกo. Dฦฐแปi ฤรขy lร chi tiแบฟt vแป cรกch sแปญ dแปฅng vร cรกc แปฉng dแปฅng phแป biแบฟn cแปงa `ALTER TABLE`.

---

## **1. Cรกc Chแปฉc Nฤng Chรญnh cแปงa ALTER TABLE**
Lแปnh `ALTER TABLE` cรณ thแป thแปฑc hiแปn nhiแปu thao tรกc khรกc nhau, bao gแปm:

### **1.1. Thรชm cแปt (ADD COLUMN)**
โ **Cรบ phรกp:**
```sql
ALTER TABLE table_name
ADD column_name datatype [constraints];
```
โ **Vรญ dแปฅ:**
```sql
ALTER TABLE employees
ADD email VARCHAR(100) NOT NULL;
```
โก **Giแบฃi thรญch:** Thรชm cแปt `email` vรo bแบฃng `employees` vแปi kiแปu dแปฏ liแปu `VARCHAR(100)` vร rรng buแปc `NOT NULL`.

---

### **1.2. Xรณa cแปt (DROP COLUMN)**
โ **Cรบ phรกp:**
```sql
ALTER TABLE table_name
DROP COLUMN column_name;
```
โ **Vรญ dแปฅ:**
```sql
ALTER TABLE employees
DROP COLUMN phone_number;
```
โก **Giแบฃi thรญch:** Xรณa cแปt `phone_number` khแปi bแบฃng `employees`.

โ **Lฦฐu รฝ:**  
- Mแปt sแป hแป quแบฃn trแป CSDL (nhฦฐ SQL Server) yรชu cแบงu kiแปm tra khรณa ngoแบกi trฦฐแปc khi xรณa.  
- Khรดng thแป xรณa cแปt ฤang ฤฦฐแปฃc sแปญ dแปฅng trong rรng buแปc (`PRIMARY KEY`, `FOREIGN KEY`).

---

### **1.3. Thay ฤแปi kiแปu dแปฏ liแปu (MODIFY/ALTER COLUMN)**
โ **Cรบ phรกp (MySQL, PostgreSQL):**
```sql
ALTER TABLE table_name
MODIFY COLUMN column_name new_datatype;
```
โ **Cรบ phรกp (SQL Server):**
```sql
ALTER TABLE table_name
ALTER COLUMN column_name new_datatype;
```
โ **Vรญ dแปฅ:**
```sql
-- MySQL/PostgreSQL
ALTER TABLE employees
MODIFY COLUMN salary DECIMAL(10, 2);

-- SQL Server
ALTER TABLE employees
ALTER COLUMN salary DECIMAL(10, 2);
```
โก **Giแบฃi thรญch:** Thay ฤแปi kiแปu dแปฏ liแปu cแปงa cแปt `salary` tแปซ `INT` sang `DECIMAL(10, 2)`.

โ **Lฦฐu รฝ:**  
- Nแบฟu dแปฏ liแปu hiแปn cรณ khรดng tฦฐฦกng thรญch vแปi kiแปu mแปi, lแปnh sแบฝ bรกo lแปi.  
- Mแปt sแป hแป quแบฃn trแป CSDL khรดng hแป trแปฃ thay ฤแปi kiแปu dแปฏ liแปu nแบฟu cแปt cรณ rรng buแปc.

---

### **1.4. ฤแปi tรชn cแปt (RENAME COLUMN)**
โ **Cรบ phรกp (MySQL, PostgreSQL):**
```sql
ALTER TABLE table_name
RENAME COLUMN old_name TO new_name;
```
โ **Cรบ phรกp (SQL Server):**
```sql
EXEC sp_rename 'table_name.old_name', 'new_name', 'COLUMN';
```
โ **Vรญ dแปฅ:**
```sql
-- MySQL/PostgreSQL
ALTER TABLE employees
RENAME COLUMN emp_name TO full_name;

-- SQL Server
EXEC sp_rename 'employees.emp_name', 'full_name', 'COLUMN';
```
โก **Giแบฃi thรญch:** ฤแปi tรชn cแปt `emp_name` thรnh `full_name`.

---

### **1.5. Thรชm rรng buแปc (ADD CONSTRAINT)**
โ **Cรบ phรกp:**
```sql
ALTER TABLE table_name
ADD CONSTRAINT constraint_name constraint_type (column_name);
```
โ **Vรญ dแปฅ:**
```sql
-- Thรชm PRIMARY KEY
ALTER TABLE employees
ADD CONSTRAINT pk_employee_id PRIMARY KEY (employee_id);

-- Thรชm FOREIGN KEY
ALTER TABLE orders
ADD CONSTRAINT fk_customer_id FOREIGN KEY (customer_id) REFERENCES customers(customer_id);

-- Thรชm CHECK constraint
ALTER TABLE products
ADD CONSTRAINT chk_price CHECK (price > 0);
```
โก **Giแบฃi thรญch:**  
- Thรชm khรณa chรญnh (`PRIMARY KEY`) cho `employee_id`.  
- Thรชm khรณa ngoแบกi (`FOREIGN KEY`) tแปซ `orders.customer_id` ฤแบฟn `customers.customer_id`.  
- Thรชm rรng buแปc `CHECK` ฤแป ฤแบฃm bแบฃo `price > 0`.

---

### **1.6. Xรณa rรng buแปc (DROP CONSTRAINT)**
โ **Cรบ phรกp:**
```sql
ALTER TABLE table_name
DROP CONSTRAINT constraint_name;
```
โ **Vรญ dแปฅ:**
```sql
ALTER TABLE employees
DROP CONSTRAINT pk_employee_id;
```
โก **Giแบฃi thรญch:** Xรณa rรng buแปc khรณa chรญnh `pk_employee_id`.

โ **Lฦฐu รฝ:**  
- Khรดng thแป xรณa `PRIMARY KEY` nแบฟu cรณ `FOREIGN KEY` tham chiแบฟu ฤแบฟn nรณ.  
- Trong MySQL, sแปญ dแปฅng `DROP PRIMARY KEY` thay vรฌ `DROP CONSTRAINT`.

---

### **1.7. ฤแปi tรชn bแบฃng (RENAME TABLE)**
โ **Cรบ phรกp (MySQL, PostgreSQL):**
```sql
ALTER TABLE old_table_name
RENAME TO new_table_name;
```
โ **Cรบ phรกp (SQL Server):**
```sql
EXEC sp_rename 'old_table_name', 'new_table_name';
```
โ **Vรญ dแปฅ:**
```sql
-- MySQL/PostgreSQL
ALTER TABLE emp_data
RENAME TO employees;

-- SQL Server
EXEC sp_rename 'emp_data', 'employees';
```
โก **Giแบฃi thรญch:** ฤแปi tรชn bแบฃng tแปซ `emp_data` thรnh `employees`.

---

## **2. แปจng Dแปฅng Thแปฑc Tแบฟ cแปงa ALTER TABLE**
1. **Thรชm cแปt mแปi khi cรณ yรชu cแบงu thay ฤแปi nghiแปp vแปฅ**  
   ```sql
   ALTER TABLE users ADD last_login DATETIME;
   ```

2. **Thay ฤแปi kiแปu dแปฏ liแปu khi mแป rแปng hแป thแปng**  
   ```sql
   ALTER TABLE products MODIFY COLUMN price DECIMAL(12, 2);
   ```

3. **Xรณa cแปt khรดng cรฒn sแปญ dแปฅng ฤแป tแปi ฦฐu CSDL**  
   ```sql
   ALTER TABLE orders DROP COLUMN old_payment_method;
   ```

4. **Thรชm rรng buแปc ฤแป ฤแบฃm bแบฃo tรญnh toรn vแบนn dแปฏ liแปu**  
   ```sql
   ALTER TABLE employees ADD CONSTRAINT chk_age CHECK (age >= 18);
   ```

5. **ฤแปi tรชn bแบฃng ฤแป phรน hแปฃp vแปi quy ฦฐแปc ฤแบทt tรชn mแปi**  
   ```sql
   ALTER TABLE emp RENAME TO employees;
   ```

---

## **3. Lฦฐu ร Khi Sแปญ Dแปฅng ALTER TABLE**
- **แบขnh hฦฐแปng ฤแบฟn hiแปu suแบฅt:** `ALTER TABLE` cรณ thแป **lock bแบฃng**, gรขy chแบญm hแป thแปng nแบฟu bแบฃng lแปn.
- **Khรดng thแป hoรn tรกc (ROLLBACK):** Mแปt sแป thay ฤแปi (nhฦฐ `DROP COLUMN`) khรดng thแป undo.
- **Kiแปm tra rรng buแปc trฦฐแปc khi xรณa:** ฤแบฃm bแบฃo khรดng cรณ `FOREIGN KEY` tham chiแบฟu ฤแบฟn cแปt hoแบทc rรng buแปc ฤang xรณa.
- **Backup dแปฏ liแปu trฦฐแปc khi thay ฤแปi lแปn.**

---

## **Kแบฟt Luแบญn**
`ALTER TABLE` lร lแปnh cแปฑc kแปณ mแบกnh mแบฝ trong SQL, giรบp **linh hoแบกt thay ฤแปi cแบฅu trรบc bแบฃng** mร khรดng cแบงn xรณa vร tแบกo lแบกi. Tuy nhiรชn, cแบงn **thแบญn trแปng** khi sแปญ dแปฅng ฤแป trรกnh lรm hแปng dแปฏ liแปu hoแบทc แบฃnh hฦฐแปng ฤแบฟn hiแปu suแบฅt.  

**Bแบกn ฤรฃ sแปญ dแปฅng `ALTER TABLE` trong bรi thแปฑc hรnh sแป 1 khi thรชm cแปt `HOCPHI` vรo bแบฃng `LOP` vร thay ฤแปi kiแปu dแปฏ liแปu cแปt `TENMH`.** ๐
